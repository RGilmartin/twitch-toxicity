{"version":3,"file":"flags_test.js","sourceRoot":"","sources":["../src/flags_test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nimport * as device_util from './device_util';\nimport * as tf from './index';\n\ndescribe('DEBUG', () => {\n  beforeEach(() => {\n    tf.env().reset();\n    spyOn(console, 'warn').and.callFake((msg: string) => {});\n  });\n  afterAll(() => tf.env().reset());\n\n  it('disabled by default', () => {\n    expect(tf.env().getBool('DEBUG')).toBe(false);\n  });\n\n  it('warns when enabled', () => {\n    const consoleWarnSpy = console.warn as jasmine.Spy;\n    tf.env().set('DEBUG', true);\n    expect(consoleWarnSpy.calls.count()).toBe(1);\n    expect((consoleWarnSpy.calls.first().args[0] as string)\n               .startsWith('Debugging mode is ON. '))\n        .toBe(true);\n\n    expect(tf.env().getBool('DEBUG')).toBe(true);\n    expect(consoleWarnSpy.calls.count()).toBe(1);\n  });\n});\n\n// TODO (yassogba) figure out why this spy is not working / fix this test.\ndescribe('IS_BROWSER', () => {\n  let isBrowser: boolean;\n  beforeEach(() => {\n    tf.env().reset();\n    spyOn(device_util, 'isBrowser').and.callFake(() => isBrowser);\n  });\n  afterAll(() => tf.env().reset());\n\n  // tslint:disable-next-line: ban\n  xit('isBrowser: true', () => {\n    isBrowser = true;\n    expect(tf.env().getBool('IS_BROWSER')).toBe(true);\n  });\n\n  // tslint:disable-next-line: ban\n  xit('isBrowser: false', () => {\n    isBrowser = false;\n    expect(tf.env().getBool('IS_BROWSER')).toBe(false);\n  });\n});\n\ndescribe('PROD', () => {\n  beforeEach(() => tf.env().reset());\n  afterAll(() => tf.env().reset());\n\n  it('disabled by default', () => {\n    expect(tf.env().getBool('PROD')).toBe(false);\n  });\n});\n\ndescribe('TENSORLIKE_CHECK_SHAPE_CONSISTENCY', () => {\n  beforeEach(() => tf.env().reset());\n  afterAll(() => tf.env().reset());\n\n  it('disabled when debug is disabled', () => {\n    tf.env().set('DEBUG', false);\n    expect(tf.env().getBool('TENSORLIKE_CHECK_SHAPE_CONSISTENCY')).toBe(false);\n  });\n\n  it('enabled when debug is enabled', () => {\n    // Silence debug warnings.\n    spyOn(console, 'warn');\n    tf.enableDebugMode();\n    expect(tf.env().getBool('TENSORLIKE_CHECK_SHAPE_CONSISTENCY')).toBe(true);\n  });\n});\n\ndescribe('DEPRECATION_WARNINGS_ENABLED', () => {\n  beforeEach(() => tf.env().reset());\n  afterAll(() => tf.env().reset());\n\n  it('enabled by default', () => {\n    expect(tf.env().getBool('DEPRECATION_WARNINGS_ENABLED')).toBe(true);\n  });\n});\n\ndescribe('IS_TEST', () => {\n  beforeEach(() => tf.env().reset());\n  afterAll(() => tf.env().reset());\n\n  it('disabled by default', () => {\n    expect(tf.env().getBool('IS_TEST')).toBe(false);\n  });\n});\n\ndescribe('async flags test', () => {\n  const asyncFlagName = 'ASYNC_FLAG';\n  beforeEach(() => tf.env().registerFlag(asyncFlagName, async () => true));\n\n  afterEach(() => tf.env().reset());\n\n  it('evaluating async flag works', async () => {\n    const flagVal = await tf.env().getAsync(asyncFlagName);\n    expect(flagVal).toBe(true);\n  });\n\n  it('evaluating async flag synchronously fails', async () => {\n    expect(() => tf.env().get(asyncFlagName)).toThrow();\n  });\n});\n"]}